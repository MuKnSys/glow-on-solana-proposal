# glow-on-solana-proposal


We propose to port *Glow* to target zk-SNARKs via Solana.
This will help solve issues of security, privacy, scalability and more for
Decentralized Applications (DApps).

For this first proposal, we will build a proof-of-concept modification to the *Glow* compiler
so it can target Solana's input language.
Unlike existing “smart contract” languages, *Glow* already generates complementary code
for both off-chain clients and on-chain smart contracts;
it thus requires the least rearchitecting to work with zk-SNARKs.
We will collaborate with Solana authors to make sure suitable features are present.

## Ecosystem Impact

Today's decentralized applications require all network participants
present and future to fully run all computations in the open.
This is both very expensive and not private at all.

Many known methods can mitigate these issues, including
Generalized State Channels, Merkleized Abstract Syntax Tree (MAST), and zk-SNARKs.
But the current tools make these techniques practically unusable for mere mortals,
requiring developers to combine expertise in many fields,
manually yet without any leeway for human mistake whatsoever.

Completely new tools are thus required to effectively write private DApps.
Our approach will offer a practical way to build and deploy private DApps on top of Filecoin.
This presents a great opportunity for Filecoin, that can thereby leapfrog other blockchains
in its support for private DApps, where it currently lags behind with regard to DApps.

Since the current proposal is for a proof of concept, the risk of failure is just
the time and money invested in building this initial work.
When we later productize these features, extra steps will have to be taken
to ensure the design and implementation are both robust against attacks.

## Product Design

For this initial proposal, we will build a *Glow* compiler backend
that targets zk-SNARKs via Solana.
The deliverable will include the following elements:
- Off-chain client code that runs on behalf of each participant,
  and uses the client part of Solana to generate and evaluate R1CS circuits.
- On-chain “smart contract code” that enforces the rules by verifying
  participant-submitted transactions using zk-SNARKs.
- Glue between the two that simulates any missing parts of the blockchain,
  using Solana for the construction and verification of zk-SNARKs.
- A working test flow of our `rock_paper_scissors` DApp
  running against the simulated blockchain.

Considering that Solana isn't a complete working part of the Solana blockchain yet,
the deliverable will an end-to-end run of a *Glow* DApp, not against the blockchain itself,
but against a minimal simulation of what the blockchain would do,
involving whichever part of Solana is working, and simulating the rest,
which would in turn invoke whatever simulation mode Solana itself provides.

## Budget Breakdown (Milestones)

Our development will include the following milestones.
We estimate that we will need the equivalent of one senior developer full-time,
one architect or product managing half-time, and
one junior developer full-time in a support role,
for the duration of the project, at the cost of $60,000 over the course of a 27 week long project.

### Milestone 1
- Study how Solana and zk-SNARK works, how to compile to circuits,
  how to interact with both circuit construction in the off-chain clients
  and circuit verification in the on-chain contract.
  The deliverable will be a markdown document
  that explains what needs to be done in greater detail.
  (3 weeks).

### Milestone 2
- Make a first attempt to add passes to the *Glow* compiler to generate Solana code.
  The deliverable will be some Scheme code that effectively generates Solana code
  for one of our DApps, but may have various limitations and short-cuts
  and not work properly in the general case,
  highlighting issues in our existing compiler infrastructure.
  (3 weeks).

### Milestone 3
- Make a first attempt to simulate a blockchain using Solana.
  The deliverable will be some Scheme, Common Lisp and/or Rust code
  that allows us to effectively run code as generated by our first compiler attempt above.
  Once again, this code may not be full-featured, but will help identify
  any issues to be fixed in our existing runtime infrastructure.
  (3 weeks).

### Milestone 4
- Analyze the limitations of the first attempt and designing
  the required deeper changes to our compiler and runtime architecture.
  The deliverable will be a markdown document
  that explains the changes required to our architecture.
  (3 weeks).

### Milestone 5
- Refactor the *Glow* compiler and runtime to enable the features
  the first attempts couldn't achieve.
  The deliverable will be modifications to our Scheme code
  to implement the above-designed changes.
  (3 weeks).

### Milestone 6
- Make a second attempt to add passes to the *Glow* compiler to generate Solana code,
  using the refactored architecture.
  The deliverable will be Scheme code that fully implements
  a *Glow* compiler backend targeting Solana.
  (3 weeks).
### Milestone 7
- Make a second attempt to simulate a blockchain using Solana.
  The deliverable will be Scheme code that fully implements
  the runtime infrastructure required to test our applications using the Solana backend.
  (3 weeks).

### Milestone 8
- Debug a flow of rock paper scissors against our simulated Solana backend.
  The deliverable will be fixes to all the above to ensure the test flows
  run flawlessly without the need for human intervention.
  (3 weeks).

### Milestone 9
- Package and documentation for the above.
  The deliverable will be changes to our packaging glue and documentation
  so that anyone can reproduce our proof of concept and run its test suite
  with a one-line command.
  (3 weeks).


